# IoT-test-postman
Данный проект предназначен для автоматического тестирования API интерфейса платформы Eltex-SC.
## Структура проекта
1. В директории Collections находятся коллекции Postman, в которых содержатся запросы и тесты.
2. В директории Environments находится 2 файла. Environment.postman_environment.json - пустое окружение которое будет заполниться в ходе работы тестов, оно необходимо для работы тестов. postman_globals.json - глобальные переменные (host и т.д.).
## Установка тесткейсов
1. Необходимо установить Postman https://www.postman.com/downloads/
2. Клонировать репозиторий https://gitlab.eltex.loc/iot-mcpe/iot-test-py.git
3. Зайти в Postman, создать Workspace, зайти в Workspace.
4. Импортировать все файлы данного проекта(кроме README.md) в Postman при помощи кнопки "Import"(она расположена в верхне левой части экрана). Желательно импортировать не все файлы сразу так в Postman была замечена ошибка, при единовременном импорте большого количества файлов, некоторые файлы не сохраняются в Postman.
5. Установить окружение Environment (верхне правая часть экрана).

## Настройка параметров для тестирования своей платформы
1. В случае если платформа расположена **НЕ** на локалхосте, необходимо изменить значение глобальных переменных host и URL_token. Для этого нужно зайти в Postman, затем в созданный ранее Workspace, перейти в раздел Environments, там выбрать Globals и изменить значения этих переменных, по аналогии с уже имеющимся значениями (например если платформа расположена по адресу 192.168.1.110 и API использует порт 1234, значение переменной host должно быть http://192.168.1.110:1234/api/v1). Таким же образом необходимо изменить значение переменной URL_token (по аналогии если платформа расположена по адресу 192.168.1.110 и API использует порт 1234, значение переменной URL_token должно быть http://192.168.1.110:1234/api/v1/oauth/token). Однако, если платформа расположена на локалхосте и API использует стандартный 8071 порт, **изменения вносить не нужно**.
2. Так как в некоторых тестах используются реальные устройства и контроллер RG-35, в разделе глобальных переменных есть переменная RG-35-WZ_mac, которая содержит mac адрес контроллера. Её значение надо изменить на mac адрес вашего контроллера.
3. Для корректного функционирования тестов связанных с секцией дашборда "Климат" необходимо хотя бы одно устройство в этой категории. Для корректного функционирования тестов связанных с секцией дашборда "Освещение" необходимо хотя бы одно устройство в этой категории, при этом оно должно иметь переключатель на дашборде, перед началом тестов каналы этого устройства должны находится во включенном состоянии. Для корректного функционирования тестов связанных с охраной необходимо хотя бы одно охранное устройство.
4. Если у админа на вашей платформе пароль отличается от Test18plat34Form , то вам необходимо заменить этот набор символов везде где он встречается на пароль админа. Это можно сделать с помощью функционала Find and Replace в Postman. Данный функционал открывается при нажатии на кнопку с соответствующим названием в нижней левой части экрана.


## Регламент для совместного участия в проекте
1. Все переменные которые неизбежно будут содержать статичные данные (такие как mac-адрес и т.д.), которые нобходимо вводить в ручную должны находится в переменных Globals.
2. Остальные переменные (кроме токенов авторизации) должны записываться в переменные окружения.
3. Если в ходе теста что-либо создается (например пользователь или дом), то перед окончанием тестирования все созднанные сущности должны быть удалены.
4. Тесты должны запускаться и корректного работать в условиях чистой базы данных.

## Общее ТЗ тесткейсов
1. При разработке тесткейса необходимо учитывать, что для тестирования многих запросов необходимо создать какие-либо условия (например создать, пользователя, дом и т.д.), эти действия должны быть включены в тесткейс (как и последующее удаление созданных сущностей).
2. Все необходимые для тестов данные должны которые можно получить с помощью выполнения API запросов, должны быть получены и записаны в переменные.
3. Тесты должны запускаться и корректного работать в условиях чистой базы данных.


## Тестирование запроса из swagger
1. Одним из самх простых способов тестирования запросов из swagger является метод который предусматривает, что известна инофрмация о том при каких условиях на платформе выполняется этот запрос. В таком случае имеется возможность получить пример данных при которых запрос будет выполен. Далее необходимо тщательно проверить работоспособность запроса с другими данными.
2. В случае если не известно при каких условиях на платформе выполняется тестируемый запрос, необходимо заполнить вручную заполнить значение полей в теле запроса(при его наличии), предварительно создав все необходимые сущности.
