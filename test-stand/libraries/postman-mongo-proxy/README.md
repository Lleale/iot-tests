# postman-mongo-proxy

# Содержание
- [Установка и запуск](#установка-и-запуск)
- [HTTP запросы](#http-запросы)


# Установка и запуск
Установка осуществляется командой:<br>
`npm install`

Запуск осуществляется командой:<br>
`node postman-mongo-proxy.mjs`


# HTTP запросы
## Добавление параметров (url и port) для подключения к mongoDB

**Запрос:** POST `{host}:3073/url`

**Тело запроса (JSON):**

|Поле|Описание|
|---|---|
|url|Адрес по которому расположена БД (например 127.0.01)|
|port|Порт для подключения к БД (например 27017)|

**Тело ответа (JSON):** "message": "Вы передали url и port для подключения к mongodb"

---
## Поиск сущности по её id
**Запрос:** POST `{host}:3073/find_one_by_id`

**Тело запроса (JSON):**
|Поле|Описание|
|---|---|
|dbName|Полное название базы (например iot-core)|
|collection|Название коллекции (например users)|
|id|id сущности, которая вернется в ответе на запрос|

**Тело ответа (JSON):** Запрошенная сущность из БД.

---
## Выгрузка всей коллекции БД
**Запрос:** POST `{host}:3073/find_all`

**Тело запроса (JSON):**
|Поле|Описание|
|---|---|
|dbName|Полное название базы (например iot-core)|
|collection|Название коллекции (например users)|

**Тело ответа (JSON):** Запрошенная коллекция БД в формате массива, элементами массива являются все сущности коллекции.

## Выполнение скрипта (который передается в этом запросе) на стороне БД, результат выполнения возвращается в качестве ответа
**Запрос:** POST `{host}:3073/db/{db_name}/search_by_script`

Примечание: в данном запросе db_name это не полное название базы, например core или broker

**Тело запроса (JavaScript):**
Запрос к БД на языке JavaScript. Для получения корректных результатов, как правило требуется добавлять к запросу .toArray(); Пример:
`db.collection('users').find({"_id" : "3"}).toArray();`

Подробную информацию о синтаксисе запросов можно узнать тут https://www.mongodb.com/docs/manual/reference/method/

**Тело ответа (JSON):** зависит от передаваемого скрипта.